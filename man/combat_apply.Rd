% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/combat_core.R
\name{combat_apply}
\alias{combat_apply}
\title{Apply a ComBat Harmonization Model}
\usage{
combat_apply(tmp, dat, batch, mod = NULL, verbose = TRUE)
}
\arguments{
\item{tmp}{Fitted model list returned by \code{\link{combat_fit}}.}

\item{dat}{Numeric matrix or data frame. Either rows or columns must match
the length of \code{batch}. If the fitted model stored a transpose flag,
the same orientation is enforced.}

\item{batch}{Factor indicating batch/site per subject. Levels must match the
levels used during fit.}

\item{mod}{Optional numeric design matrix of covariates. Must match the
fit-time design (column count and names); missing fit-time columns are
zero-padded, but new columns are rejected.}

\item{verbose}{Logical. Print progress messages.}
}
\value{
A list with harmonized data and fitted parameters used in adjustment:
\itemize{
  \item \code{dat.combat}: adjusted data matrix in the original orientation
  \item batch/EB parameter estimates and priors for auditing
}
}
\description{
Applies a fitted ComBat model (from \code{\link{combat_fit}}) to new data with
matching batch levels and covariate design. Supports no-op models returned
by \code{single_batch = "return"}.
}
