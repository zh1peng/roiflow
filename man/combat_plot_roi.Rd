% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/combat_plot.R
\name{combat_plot_roi}
\alias{combat_plot_roi}
\title{Plot ROI-Level ComBat Diagnostics (Case vs Control, Before vs After)}
\usage{
combat_plot_roi(
  df_before,
  df_after,
  roi = NULL,
  site_col = "Site",
  group_col = "Group",
  value_col = "value",
  roi_col = "roi",
  study_col = NULL,
  site = NULL,
  study = NULL,
  split = FALSE,
  ylab = NULL,
  title = NULL,
  subtitle = NULL,
  palette = NULL,
  point_size = 1.8,
  point_alpha = 0.55,
  box_alpha = 0.35,
  box_width = 0.7,
  jitter_width = 0.12,
  dodge_width = 0.75,
  legend_position = "right",
  theme = c("minimal", "classic", "bw"),
  base_size = 11,
  save = FALSE,
  out_file = NULL,
  width = 10,
  height = 4.5,
  dpi = 300
)
}
\arguments{
\item{df_before}{Data frame (or object with \code{$data}) before ComBat.}

\item{df_after}{Data frame (or object with \code{$data}) after ComBat.}

\item{roi}{Character scalar ROI name. If \code{NULL}, a package default ROI
is inferred from available columns/labels.}

\item{site_col}{Character site column name.}

\item{group_col}{Character group column name.}

\item{value_col}{Character value column name for long format.}

\item{roi_col}{Character ROI-name column for long format.}

\item{study_col}{Optional character study column name. If \code{NULL} and a
\code{"Study"} column exists in both data sets, it is used automatically.}

\item{site}{Optional character vector to filter sites.}

\item{study}{Optional character vector to filter studies.}

\item{split}{Logical. If \code{FALSE} (default), returns one faceted plot
(\code{stage = before/after}). If \code{TRUE}, returns two separate plots
in a \code{combat_roi_plot_split} object.}

\item{ylab}{Optional y-axis label.}

\item{title}{Optional plot title.}

\item{subtitle}{Optional plot subtitle.}

\item{palette}{Optional named/unnamed vector of group colors.}

\item{point_size}{Numeric point size.}

\item{point_alpha}{Numeric point alpha.}

\item{box_alpha}{Numeric box alpha.}

\item{box_width}{Numeric box width.}

\item{jitter_width}{Numeric horizontal jitter width.}

\item{dodge_width}{Numeric dodge width between groups.}

\item{legend_position}{Legend position string.}

\item{theme}{Theme choice: \code{"minimal"}, \code{"classic"}, \code{"bw"}.}

\item{base_size}{Base text size.}

\item{save}{Logical. Save output image(s) via \code{ggsave}.}

\item{out_file}{Output filename. For \code{split = TRUE}, use length-1
(auto-suffixed) or length-2 vector.}

\item{width}{Plot width for saving (inches).}

\item{height}{Plot height for saving (inches).}

\item{dpi}{Plot DPI for saving.}
}
\value{
If \code{split = FALSE}, a \code{ggplot} object.

If \code{split = TRUE}, a list with class \code{combat_roi_plot_split}
containing \code{$before} and \code{$after} ggplot objects.
}
\description{
Visual diagnostic for ComBat effects on a single ROI, stratified by
site (or study-site) and group (e.g., case vs control), comparing
before versus after harmonization.

The function accepts wide or long-format tables and can be used directly
with data frames produced by \code{\link{combat_fit_df}} /
\code{\link{combat_apply_df}} workflows.
}
\examples{
set.seed(1)
n <- 80
site <- rep(c("S1", "S2"), each = n / 2)
group <- rep(rep(c("Control", "Case"), each = n / 4), 2)
roi_before <- stats::rnorm(n) + ifelse(site == "S2", 0.8, 0) + ifelse(group == "Case", 0.4, 0)
roi_after <- roi_before - ifelse(site == "S2", 0.7, 0) + stats::rnorm(n, sd = 0.05)
df_before <- data.frame(Site = site, Group = group, banksts = roi_before)
df_after <- data.frame(Site = site, Group = group, banksts = roi_after)

p <- combat_plot_roi(df_before, df_after, roi = "banksts")
}
