% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spin_core.R
\name{spin_correlation}
\alias{spin_correlation}
\title{Spin Correlation Test for Two Maps or Multi-Map Matrices}
\usage{
spin_correlation(
  x,
  y = NULL,
  perm_id = NULL,
  n_perm = 10000L,
  method = c("pearson", "spearman"),
  na_action = c("error", "pairwise"),
  seed = NULL,
  parallel = FALSE,
  n_cores = 2L,
  lh_centroid_data = NULL,
  rh_centroid_data = NULL,
  atlas = "desikan_68",
  return_null = TRUE,
  return_perm_id = FALSE
)
}
\arguments{
\item{x}{Numeric vector/matrix/data.frame. Rows must represent aligned ROIs.}

\item{y}{Optional numeric vector/matrix/data.frame. If \code{NULL}, performs
pairwise testing within \code{x}.}

\item{perm_id}{Optional permutation matrix (\code{n_roi x n_perm}). If
\code{NULL}, permutations are generated from centroid data.}

\item{n_perm}{Integer. Number of permutations (used when \code{perm_id} is
\code{NULL}).}

\item{method}{Correlation method: \code{"pearson"} or \code{"spearman"}.}

\item{na_action}{Missing-data handling: \code{"error"} or \code{"pairwise"}.}

\item{seed}{Optional integer seed.}

\item{parallel}{Logical. Compute null distributions in parallel.}

\item{n_cores}{Integer. Number of cores when \code{parallel = TRUE}.}

\item{lh_centroid_data}{Optional LH centroid data frame (if generating
permutations).}

\item{rh_centroid_data}{Optional RH centroid data frame (if generating
permutations).}

\item{atlas}{Character metadata tag (e.g. \code{"desikan_68"}).}

\item{return_null}{Logical. Include null distributions in output.}

\item{return_perm_id}{Logical. Include permutation matrix in output.}
}
\value{
An object of class \code{"spin_correlation_result"} with fields:
\itemize{
  \item \code{observed}: observed correlation matrix
  \item \code{p_value}: spin p-value matrix
  \item \code{null_xy}, \code{null_yx}: null arrays (optional)
  \item \code{summary}: tidy long table
  \item \code{meta}: run metadata (method, n_perm, seed, atlas, timestamp, ...)
}
}
\description{
Runs a spatial permutation (spin) correlation test for:
\itemize{
  \item Two maps: \code{vector vs vector}
  \item Multi-map: \code{matrix/data.frame vs matrix/data.frame}
}

The function is side-effect free and returns a structured object. Optional
saving and plotting are handled by separate helpers.
}
