% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pet_corr.R
\name{pet_corr}
\alias{pet_corr}
\title{Correlate Brain Map(s) with PET Map(s) Using Spin Tests}
\usage{
pet_corr(
  brain,
  pet = NULL,
  pet_select = NULL,
  ...,
  n_perm = 5000L,
  method = c("pearson", "spearman"),
  seed = NULL,
  centroids = NULL,
  hemi = c("both", "left", "right"),
  na_action = c("omit", "error"),
  return_null = FALSE,
  p_adjust = c("none", "fdr"),
  p_adjust_scope = c("global", "brain_map"),
  parallel = FALSE,
  n_cores = 2L,
  save = FALSE,
  out_dir = ".",
  out_prefix = "pet_corr_results"
)
}
\arguments{
\item{brain}{Numeric vector, matrix, or data.frame. Columns are brain maps.}

\item{pet}{Optional numeric vector/matrix/data.frame of PET maps.}

\item{pet_select}{Optional character vector of PET map names to select.}

\item{...}{Optional named arguments. Supported: \code{perm_id}.}

\item{n_perm}{Integer number of spin permutations.}

\item{method}{Correlation method: \code{"pearson"} or \code{"spearman"}.}

\item{seed}{Optional integer seed.}

\item{centroids}{Optional list with \code{lh} and \code{rh} centroid data.}

\item{hemi}{Hemisphere selection: \code{"both"}, \code{"left"}, \code{"right"}.}

\item{na_action}{Missing data policy: \code{"omit"} or \code{"error"}.}

\item{return_null}{Logical. If \code{TRUE}, return null vectors.}

\item{p_adjust}{Multiple-comparison adjustment for \code{p_spin}:
\code{"none"} or \code{"fdr"}.}

\item{p_adjust_scope}{Adjustment scope when \code{p_adjust = "fdr"}:
\code{"global"} or \code{"brain_map"}.}

\item{parallel}{Logical. Parallel null computation.}

\item{n_cores}{Integer. Number of cores for parallel computation.}

\item{save}{Logical. If \code{TRUE}, write csv/rds output files.}

\item{out_dir}{Output directory used when \code{save = TRUE}.}

\item{out_prefix}{Output file prefix used when \code{save = TRUE}.}
}
\value{
Object of class \code{"pet_corr_result"} with:
\itemize{
  \item \code{results}: tidy results table
  \item \code{nulls}: optional null vectors per map pair
  \item \code{meta}: metadata, settings, and provenance
  \item \code{inputs}: aligned matrices used for correlation
}
}
\description{
Runs observed + spin-test correlations between one or more query brain maps
and one or more PET maps.

PET maps can be supplied directly via \code{pet}, or selected from packaged
PET data via \code{pet_select}. By default, \code{pet = NULL} uses all
packaged PET maps.
}
\examples{
data(pet_maps_dk68)
brain <- pet_maps_dk68[, "D1"] + stats::rnorm(nrow(pet_maps_dk68), sd = 0.05)
perm_id <- replicate(25, sample.int(nrow(pet_maps_dk68)), simplify = "matrix")
res <- pet_corr(
  brain = brain,
  pet_select = c("D1", "D2"),
  n_perm = 25,
  seed = 123,
  perm_id = perm_id
)
head(res$results)
}
